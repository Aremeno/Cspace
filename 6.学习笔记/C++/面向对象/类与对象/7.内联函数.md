# 内联函数

内联函数是通过在函数定义前加上关键字`inline`来声明的函数。

当函数被声明为内联时，编译器会尝试将函数调用处替换为函数体的代码，从而减少函数调用的开销。

## 主要意义与用途

### 消除函数调用开销

```cpp
// 普通函数调用

int add(int a, int b) {
    return a + b;
}

// 内联函数调用
inline int inline_add(int a, int b) {
    return a + b;
}

int main() {
    int x = 5, y = 10;
    // 普通函数调用：有压栈、跳转、返回等开销
    int result1 = add(x, y);      
    // 内联函数调用：可能被展开为直接的加法操作，消除函数调用开销   
    int result2 = inline_add(x, y); 
}
```

### 替代宏定义

内联函数可以替代宏定义，提供类型安全和更好的调试支持。

```cpp
// 不安全的宏定义
#define MAX(a, b) ((a) > (b) ? (a) : (b))
// 类型安全的内联函数
inline int max(int a, int b) {
    return (a > b) ? a : b;
}
// 为何更安全？

int main() {
    int x = 5, y = 3;
    // 宏的问题：参数可能被多次求值，导致副作用
    int max2 = MAX(++x, y); // x会被递增两次
    // 内联函数：参数只被求值一次
    int max1 = max(++x, y); // x只递增一次
}
```

### 编译器优化的提示

内联函数为编译器提供了优化的机会，尤其是在小函数中，可以减少函数调用的开销，提高性能。

## 注意事项

### 适合内联的情况

- 函数体较小，通常只有几行代码。
- 频繁调用的函数。
- 性能关键路径上的函数。
- 简单的访问器函数（getter/setter）。

### 不适合内联的情况

- 函数体较大，内联会增加代码体积。
- 递归函数。
- 包含复杂控制结构的函数。
- 虚函数（因为动态绑定的原因）。